# è®­ç»ƒè¾“å‡ºæ”¹è¿›åˆ†æ

**æ—¥æœŸ**: 2025-11-30
**å‚è€ƒ**: LPMMçŸ¥è¯†åº“è®­ç»ƒè¾“å‡º
**ç›®æ ‡**: æ”¹è¿›APTæ¨¡å‹è®­ç»ƒè¾“å‡ºçš„ä¸“ä¸šæ€§å’Œå¯è¯»æ€§

---

## ğŸ“Š ç¤ºä¾‹è¾“å‡ºåˆ†æï¼ˆLPMMçŸ¥è¯†åº“ï¼‰

### å®é™…è¾“å‡ºç¤ºä¾‹ï¼š
```
11-30 00:18:33 [LPMMçŸ¥è¯†åº“-ä¿¡æ¯æå–] å·²å¤„ç†"%s" positional_args=('5. ç»æµä¸æ”¿æ²»ç»“æ„...',)
â ™ æ­£åœ¨è¿›è¡Œæå–ï¼š â•¸â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”   2%   40/1922 â€¢ 0:00:27 < 0:21:55
11-30 00:18:34 [model_utils] æ¨¡å‹ 'siliconflow-deepseek-v3.2' é‡åˆ°ç½‘ç»œé”™è¯¯(å¯é‡è¯•): è¿æ¥å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶æ€æˆ–URLæ˜¯å¦æ­£ç¡®ã€‚å‰©ä½™é‡è¯•æ¬¡æ•°: 2
â § æ­£åœ¨è¿›è¡Œæå–ï¼š â•¸â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”   2%   40/1922 â€¢ 0:00:29 < 0:21:55
11-30 00:18:36 [lpmm] å®ä½“ æå–å¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯ï¼šå®ä½“æå–ç»“æœä¸ºç©º
11-30 00:18:36 [lpmm] å®ä½“æå–å¤±è´¥ï¼Œå·²è¾¾æœ€å¤§é‡è¯•æ¬¡æ•°
11-30 00:18:36 [LPMMçŸ¥è¯†åº“-ä¿¡æ¯æå–] æ‰¾åˆ°ç¼“å­˜çš„æå–ç»“æœï¼šaadf03832bfb9e7e...
11-30 00:18:36 [LPMMçŸ¥è¯†åº“-ä¿¡æ¯æå–] æå–å¤±è´¥ï¼š97f868069b5f9b24955aa4f9b802c74d...
```

---

## âœ… ä¼˜ç§€ç‰¹æ€§åˆ†æ

### 1. **æ—¶é—´æˆ³ï¼ˆç²¾ç¡®åˆ°ç§’ï¼‰**
```
11-30 00:18:33
11-30 00:18:34
11-30 00:18:36
```
**ä¼˜ç‚¹**:
- æ¸…æ¥šçŸ¥é“æ¯ä¸ªæ“ä½œçš„æ‰§è¡Œæ—¶é—´
- å¯ä»¥åˆ†ææ€§èƒ½ç“¶é¢ˆï¼ˆå“ªé‡Œè€—æ—¶é•¿ï¼‰
- ä¾¿äºè°ƒè¯•ï¼ˆçŸ¥é“ä»€ä¹ˆæ—¶å€™å‡ºé”™ï¼‰

---

### 2. **æ¨¡å—åŒ–æ—¥å¿—æ ‡ç­¾**
```
[LPMMçŸ¥è¯†åº“-ä¿¡æ¯æå–]
[model_utils]
[lpmm]
```
**ä¼˜ç‚¹**:
- å¿«é€Ÿå®šä½é—®é¢˜æ¥æº
- æ—¥å¿—åˆ†ç±»æ¸…æ™°
- ä¾¿äºè¿‡æ»¤å’Œæœç´¢

---

### 3. **åŠ¨æ€è¿›åº¦æ¡ï¼ˆå¸¦åŠ¨ç”»ï¼‰**
```
â ™ æ­£åœ¨è¿›è¡Œæå–ï¼š â•¸â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”   2%   40/1922 â€¢ 0:00:27 < 0:21:55
â § æ­£åœ¨è¿›è¡Œæå–ï¼š â•¸â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”   2%   40/1922 â€¢ 0:00:29 < 0:21:55
â ‡ æ­£åœ¨è¿›è¡Œæå–ï¼š â•¸â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”   2%   45/1922 â€¢ 0:00:35 < 0:20:56
```

**ç‰¹æ€§**:
- â ™â §â ‡ - æ—‹è½¬åŠ¨ç”»ï¼ˆè¡¨ç¤ºç¨‹åºåœ¨è¿è¡Œï¼‰
- â•¸â”â”â”â” - è¿›åº¦æ¡
- 2% - å®Œæˆç™¾åˆ†æ¯”
- 40/1922 - å½“å‰/æ€»æ•°
- 0:00:27 - å·²ç”¨æ—¶é—´
- 0:21:55 - é¢„è®¡å‰©ä½™æ—¶é—´

**ä½¿ç”¨åº“**: å¯èƒ½æ˜¯ `rich` æˆ– `tqdm`

---

### 4. **æ™ºèƒ½é‡è¯•æœºåˆ¶**
```
æ¨¡å‹ 'siliconflow-deepseek-v3.2' é‡åˆ°ç½‘ç»œé”™è¯¯(å¯é‡è¯•): è¿æ¥å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶æ€æˆ–URLæ˜¯å¦æ­£ç¡®ã€‚å‰©ä½™é‡è¯•æ¬¡æ•°: 2
```
**ä¼˜ç‚¹**:
- æ˜ç¡®å‘ŠçŸ¥é”™è¯¯ç±»å‹
- æ˜¾ç¤ºå‰©ä½™é‡è¯•æ¬¡æ•°
- ç»™å‡ºè§£å†³å»ºè®®

---

### 5. **ç¼“å­˜æœºåˆ¶æç¤º**
```
æ‰¾åˆ°ç¼“å­˜çš„æå–ç»“æœï¼šaadf03832bfb9e7e19a43935f3d800b5a1cec6aa8237cbc8a8122c35c4aac87b
```
**ä¼˜ç‚¹**:
- å‘ŠçŸ¥ç”¨æˆ·ä½¿ç”¨äº†ç¼“å­˜ï¼ˆåŠ é€Ÿï¼‰
- æ˜¾ç¤ºç¼“å­˜å“ˆå¸Œå€¼ï¼ˆå¯è¿½è¸ªï¼‰

---

### 6. **æ¸…æ™°çš„é”™è¯¯æŠ¥å‘Š**
```
å®ä½“ æå–å¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯ï¼šå®ä½“æå–ç»“æœä¸ºç©º
å®ä½“æå–å¤±è´¥ï¼Œå·²è¾¾æœ€å¤§é‡è¯•æ¬¡æ•°
æå–å¤±è´¥ï¼š97f868069b5f9b24955aa4f9b802c74d33705bbbb0832366e88afd6fec1ddc3e
```
**ä¼˜ç‚¹**:
- æ˜ç¡®æŒ‡å‡ºå¤±è´¥åŸå› 
- è¯´æ˜å¤±è´¥çŠ¶æ€ï¼ˆå·²è¾¾æœ€å¤§é‡è¯•ï¼‰
- æä¾›å¤±è´¥è®°å½•çš„å“ˆå¸ŒID

---

## ğŸ” å½“å‰APTè®­ç»ƒå™¨è¾“å‡ºåˆ†æ

### å½“å‰è¾“å‡ºç¤ºä¾‹ï¼ˆæ¨æµ‹ï¼‰ï¼š
```python
# åŸºäºtrainer.pyçš„ä»£ç æ¨æµ‹
info_print(f"å¼€å§‹è®­ç»ƒï¼Œæ€»å…± {epochs} è½®...")

for epoch in range(epochs):
    progress_bar = tqdm(dataloader, desc=f"Epoch {epoch+1}/{epochs}")
    for i, batch in enumerate(progress_bar):
        # å¤„ç†æ‰¹æ¬¡
        progress_bar.set_postfix({
            "loss": f"{loss_value:.4f}",
            "lr": f"{scheduler.get_last_lr()[0]:.6f}"
        })

    info_print(f"Epoch {epoch+1}/{epochs} å®Œæˆ, å¹³å‡æŸå¤±: {avg_loss:.4f}")
```

**å®é™…è¾“å‡ºå¯èƒ½æ˜¯**:
```
å¼€å§‹è®­ç»ƒï¼Œæ€»å…± 10 è½®...
Epoch 1/10: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 500/500 [02:30<00:00, loss=2.5432, lr=0.000100]
Epoch 1/10 å®Œæˆ, å¹³å‡æŸå¤±: 2.5432
å‘ç°æ–°çš„æœ€ä½³æ¨¡å‹ï¼Œå·²ä¿å­˜åˆ° ./apt_model
Epoch 2/10: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 500/500 [02:32<00:00, loss=2.3456, lr=0.000095]
...
```

---

## ğŸ“‹ å½“å‰APTè¾“å‡ºçš„ä¸è¶³

### 1. **ç¼ºå°‘æ—¶é—´æˆ³**
- âŒ ä¸çŸ¥é“æ¯ä¸ªepochçš„ç¡®åˆ‡æ—¶é—´
- âŒ éš¾ä»¥åˆ†ææ€§èƒ½ç“¶é¢ˆ
- âŒ è°ƒè¯•æ—¶éš¾ä»¥å®šä½é—®é¢˜

### 2. **æ—¥å¿—æ ‡ç­¾ä¸å¤Ÿè¯¦ç»†**
- âŒ æ²¡æœ‰æ¨¡å—çº§åˆ«çš„æ ‡ç­¾
- âŒ éš¾ä»¥åŒºåˆ†æ—¥å¿—æ¥æº

### 3. **è¿›åº¦ä¿¡æ¯ä¸å¤Ÿä¸°å¯Œ**
- âš ï¸ æœ‰åŸºæœ¬çš„tqdmè¿›åº¦æ¡
- âŒ ä½†ç¼ºå°‘ï¼š
  - åŠ¨æ€æ—‹è½¬åŠ¨ç”»ï¼ˆè¡¨æ˜ç¨‹åºè¿è¡Œï¼‰
  - å·²ç”¨æ—¶é—´/å‰©ä½™æ—¶é—´ï¼ˆè™½ç„¶tqdmæœ‰ï¼Œä½†æ ¼å¼ä¸å¤Ÿæ¸…æ™°ï¼‰
  - å½“å‰æ­¥æ•°/æ€»æ­¥æ•°ï¼ˆbatchçº§åˆ«ï¼‰

### 4. **ç¼ºå°‘é‡è¯•æœºåˆ¶æç¤º**
- âŒ å¦‚æœbatchå¤„ç†å¤±è´¥ï¼Œåªæ˜¯è·³è¿‡
- âŒ æ²¡æœ‰é‡è¯•è®¡æ•°
- âŒ æ²¡æœ‰é”™è¯¯ç±»å‹è¯´æ˜

### 5. **ç¼ºå°‘ç¼“å­˜æç¤º**
- âŒ æ²¡æœ‰checkpointç¼“å­˜æç¤º
- âŒ ç”¨æˆ·ä¸çŸ¥é“æ˜¯å¦ä½¿ç”¨äº†å·²æœ‰checkpoint

### 6. **é”™è¯¯ä¿¡æ¯ä¸å¤Ÿè¯¦ç»†**
- âš ï¸ æœ‰åŸºæœ¬çš„try-except
- âŒ ä½†é”™è¯¯ä¿¡æ¯ä¸å¤Ÿç»“æ„åŒ–

---

## ğŸ¯ æ”¹è¿›å»ºè®®

### æ”¹è¿›æ–¹æ¡ˆA: åŸºç¡€æ”¹è¿›ï¼ˆ1-2å°æ—¶ï¼‰

#### 1. æ·»åŠ æ—¶é—´æˆ³åˆ°æ‰€æœ‰æ—¥å¿—
```python
import logging
from datetime import datetime

def setup_logger(name, log_file=None):
    """è®¾ç½®å¸¦æ—¶é—´æˆ³çš„logger"""
    formatter = logging.Formatter(
        '%(asctime)s [%(name)s] %(message)s',
        datefmt='%m-%d %H:%M:%S'
    )

    handler = logging.StreamHandler()
    handler.setFormatter(formatter)

    logger = logging.getLogger(name)
    logger.addHandler(handler)
    logger.setLevel(logging.INFO)

    return logger

# ä½¿ç”¨
logger = setup_logger('APT-Trainer')
logger.info("å¼€å§‹è®­ç»ƒï¼Œæ€»å…± 10 è½®...")
# è¾“å‡º: 11-30 00:18:33 [APT-Trainer] å¼€å§‹è®­ç»ƒï¼Œæ€»å…± 10 è½®...
```

#### 2. æ”¹è¿›è¿›åº¦æ¡ï¼ˆä½¿ç”¨richï¼‰
```python
from rich.progress import (
    Progress,
    SpinnerColumn,
    BarColumn,
    TextColumn,
    TimeRemainingColumn,
    TimeElapsedColumn,
)

# åˆ›å»ºå¯Œè¿›åº¦æ¡
with Progress(
    SpinnerColumn(),           # æ—‹è½¬åŠ¨ç”»
    TextColumn("[bold blue]{task.description}"),
    BarColumn(),               # è¿›åº¦æ¡
    TextColumn("[progress.percentage]{task.percentage:>3.0f}%"),
    TextColumn("{task.completed}/{task.total}"),
    TimeElapsedColumn(),       # å·²ç”¨æ—¶é—´
    TimeRemainingColumn(),     # å‰©ä½™æ—¶é—´
) as progress:
    task = progress.add_task("è®­ç»ƒä¸­", total=len(dataloader))

    for batch in dataloader:
        # å¤„ç†æ‰¹æ¬¡
        progress.update(task, advance=1)
```

**è¾“å‡ºæ•ˆæœ**:
```
â ™ è®­ç»ƒä¸­ â”â”â”â”â•¸â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  15%  75/500  0:00:30  0:02:30
```

#### 3. æ·»åŠ checkpointç¼“å­˜æç¤º
```python
if checkpoint_manager.has_existing_checkpoints():
    logger.info("æ‰¾åˆ°å·²æœ‰checkpointï¼Œå¯ä»¥æ¢å¤è®­ç»ƒ")
    latest = checkpoint_manager.get_latest_checkpoint()
    logger.info(f"æœ€æ–°checkpoint: epoch {latest['epoch']}, step {latest['step']}")

    user_choice = input("æ˜¯å¦ä»checkpointæ¢å¤? (y/n): ")
    if user_choice.lower() == 'y':
        logger.info(f"ä»checkpointæ¢å¤: {latest['path']}")
```

---

### æ”¹è¿›æ–¹æ¡ˆB: é«˜çº§æ”¹è¿›ï¼ˆ3-4å°æ—¶ï¼‰

#### 4. ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ
```python
class TrainingLogger:
    """è®­ç»ƒæ—¥å¿—ç®¡ç†å™¨"""

    def __init__(self, name="APT-Trainer", log_file=None):
        self.logger = logging.getLogger(name)
        self.setup_handlers(log_file)

    def setup_handlers(self, log_file):
        """è®¾ç½®æ—¥å¿—å¤„ç†å™¨"""
        formatter = logging.Formatter(
            '%(asctime)s [%(name)s-%(levelname)s] %(message)s',
            datefmt='%m-%d %H:%M:%S'
        )

        # æ§åˆ¶å°è¾“å‡º
        console_handler = logging.StreamHandler()
        console_handler.setFormatter(formatter)
        console_handler.setLevel(logging.INFO)

        self.logger.addHandler(console_handler)

        # æ–‡ä»¶è¾“å‡ºï¼ˆå¯é€‰ï¼‰
        if log_file:
            file_handler = logging.FileHandler(log_file)
            file_handler.setFormatter(formatter)
            file_handler.setLevel(logging.DEBUG)
            self.logger.addHandler(file_handler)

        self.logger.setLevel(logging.DEBUG)

    def epoch_start(self, epoch, total_epochs):
        """è®°å½•epochå¼€å§‹"""
        self.logger.info(f"â”â”â” Epoch {epoch}/{total_epochs} å¼€å§‹ â”â”â”")

    def epoch_end(self, epoch, metrics):
        """è®°å½•epochç»“æŸ"""
        self.logger.info(
            f"Epoch {epoch} å®Œæˆ - "
            f"Loss: {metrics['loss']:.4f}, "
            f"LR: {metrics['lr']:.6f}"
        )

    def checkpoint_saved(self, path, epoch, step):
        """è®°å½•checkpointä¿å­˜"""
        self.logger.info(f"âœ“ Checkpointå·²ä¿å­˜: epoch {epoch}, step {step}")
        self.logger.debug(f"  è·¯å¾„: {path}")

    def error(self, component, message, retry_count=None):
        """è®°å½•é”™è¯¯"""
        msg = f"[{component}] é”™è¯¯: {message}"
        if retry_count is not None:
            msg += f" (å‰©ä½™é‡è¯•: {retry_count})"
        self.logger.error(msg)
```

#### 5. æ·»åŠ é‡è¯•æœºåˆ¶
```python
from tenacity import retry, stop_after_attempt, wait_exponential

@retry(
    stop=stop_after_attempt(3),
    wait=wait_exponential(multiplier=1, min=2, max=10),
    reraise=True
)
def process_batch_with_retry(model, batch, logger):
    """å¸¦é‡è¯•çš„batchå¤„ç†"""
    try:
        return _process_batch_impl(model, batch)
    except Exception as e:
        logger.error(
            "Batchå¤„ç†",
            f"å¤„ç†å¤±è´¥: {str(e)}",
            retry_count=2  # æ ¹æ®å®é™…é‡è¯•æ¬¡æ•°
        )
        raise
```

---

### æ”¹è¿›æ–¹æ¡ˆC: å®Œæ•´æ”¹è¿›ï¼ˆ6-8å°æ—¶ï¼‰

#### 6. å®æ—¶è®­ç»ƒä»ªè¡¨ç›˜ï¼ˆä½¿ç”¨rich.liveï¼‰
```python
from rich.live import Live
from rich.table import Table
from rich.panel import Panel
from rich.layout import Layout

class TrainingDashboard:
    """å®æ—¶è®­ç»ƒä»ªè¡¨ç›˜"""

    def __init__(self):
        self.layout = Layout()
        self.setup_layout()

    def setup_layout(self):
        """è®¾ç½®å¸ƒå±€"""
        self.layout.split_column(
            Layout(name="header", size=3),
            Layout(name="progress", size=5),
            Layout(name="metrics", size=10),
            Layout(name="logs", size=10),
        )

    def update_header(self, epoch, total_epochs):
        """æ›´æ–°æ ‡é¢˜"""
        header = Panel(
            f"APTæ¨¡å‹è®­ç»ƒ - Epoch {epoch}/{total_epochs}",
            style="bold blue"
        )
        self.layout["header"].update(header)

    def update_metrics(self, metrics):
        """æ›´æ–°æŒ‡æ ‡è¡¨æ ¼"""
        table = Table(title="è®­ç»ƒæŒ‡æ ‡")
        table.add_column("æŒ‡æ ‡", style="cyan")
        table.add_column("å€¼", style="magenta")

        for key, value in metrics.items():
            table.add_row(key, f"{value:.4f}")

        self.layout["metrics"].update(table)

    def run(self):
        """è¿è¡Œä»ªè¡¨ç›˜"""
        with Live(self.layout, refresh_per_second=4):
            # è®­ç»ƒå¾ªç¯
            pass
```

**æ•ˆæœ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ APTæ¨¡å‹è®­ç»ƒ - Epoch 3/10                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â ™ è®­ç»ƒä¸­ â”â”â”â”â•¸â”â”â”â”â”â”â”â”â”â” 15% 75/500 0:00:30 < 0:02:30

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€ è®­ç»ƒæŒ‡æ ‡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŒ‡æ ‡          å€¼           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Loss          2.5432      â”‚
â”‚ Learning Rate 0.000100    â”‚
â”‚ GPU Memory    8.5GB/16GB  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Recent Logs]
11-30 00:18:33 âœ“ Checkpointå·²ä¿å­˜
11-30 00:18:35 Batch 75 å®Œæˆ
11-30 00:18:37 Batch 76 å®Œæˆ
```

---

## ğŸ“ å…·ä½“å®ç°æ­¥éª¤

### æ­¥éª¤1: æ”¹è¿›æ—¥å¿—ç³»ç»Ÿï¼ˆä¼˜å…ˆï¼‰

**æ–‡ä»¶**: `apt_model/training/trainer.py`

**æ”¹åŠ¨**:
```python
# åœ¨æ–‡ä»¶é¡¶éƒ¨æ·»åŠ 
from datetime import datetime
import logging

# è®¾ç½®logger
logger = logging.getLogger('APT-Trainer')
handler = logging.StreamHandler()
formatter = logging.Formatter(
    '%(asctime)s [%(name)s] %(message)s',
    datefmt='%m-%d %H:%M:%S'
)
handler.setFormatter(formatter)
logger.addHandler(handler)
logger.setLevel(logging.INFO)

# æ›¿æ¢æ‰€æœ‰ info_print() ä¸º logger.info()
# æ›¿æ¢æ‰€æœ‰ debug_print() ä¸º logger.debug()
```

---

### æ­¥éª¤2: æ”¹è¿›è¿›åº¦æ¡ï¼ˆæ¨èï¼‰

**å®‰è£…rich**:
```bash
pip install rich
```

**æ”¹åŠ¨**:
```python
from rich.progress import Progress, SpinnerColumn, BarColumn, TextColumn, TimeElapsedColumn, TimeRemainingColumn

# åœ¨è®­ç»ƒå¾ªç¯ä¸­
with Progress(
    SpinnerColumn(),
    TextColumn("[bold blue]{task.description}"),
    BarColumn(),
    TextColumn("[progress.percentage]{task.percentage:>3.0f}%"),
    TextColumn("{task.completed}/{task.total}"),
    TimeElapsedColumn(),
    TimeRemainingColumn(),
) as progress:
    epoch_task = progress.add_task(f"Epoch {epoch+1}/{epochs}", total=len(dataloader))

    for i, batch in enumerate(dataloader):
        # å¤„ç†æ‰¹æ¬¡
        progress.update(epoch_task, advance=1, description=f"Epoch {epoch+1}/{epochs} [Loss: {loss_value:.4f}]")
```

---

### æ­¥éª¤3: æ·»åŠ checkpointæç¤ºï¼ˆå¿…è¦ï¼‰

**æ”¹åŠ¨**:
```python
# åœ¨è®­ç»ƒå¼€å§‹å‰
if os.path.exists(os.path.join(save_path, "checkpoints")):
    checkpoint_files = os.listdir(os.path.join(save_path, "checkpoints"))
    if checkpoint_files:
        logger.info(f"æ‰¾åˆ° {len(checkpoint_files)} ä¸ªå·²æœ‰checkpoint")
        # è¯¢é—®æ˜¯å¦æ¢å¤
```

---

## ğŸ¨ æœ€ç»ˆæ•ˆæœé¢„è§ˆ

### æ”¹è¿›å‰:
```
å¼€å§‹è®­ç»ƒï¼Œæ€»å…± 10 è½®...
Epoch 1/10: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 500/500 [02:30<00:00, loss=2.5432, lr=0.000100]
Epoch 1/10 å®Œæˆ, å¹³å‡æŸå¤±: 2.5432
å‘ç°æ–°çš„æœ€ä½³æ¨¡å‹ï¼Œå·²ä¿å­˜åˆ° ./apt_model
```

### æ”¹è¿›å:
```
11-30 00:18:33 [APT-Trainer] å¼€å§‹è®­ç»ƒï¼Œæ€»å…± 10 è½®...
11-30 00:18:33 [APT-Trainer] æ‰¾åˆ° 3 ä¸ªå·²æœ‰checkpoint
11-30 00:18:33 [APT-Trainer] â”â”â” Epoch 1/10 å¼€å§‹ â”â”â”
â ™ Epoch 1/10 â”â”â”â”â”â”â•¸â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  15%  75/500 â€¢ 0:00:30 < 0:02:30
11-30 00:18:55 [APT-Trainer] Batch 100/500 - Loss: 2.5432, LR: 0.000100
11-30 00:19:20 [APT-Trainer] Batch 200/500 - Loss: 2.4521, LR: 0.000095
â § Epoch 1/10 â”â”â”â”â”â”â”â”â”â”â•¸â”â”â”â”â”â”â”â”â”â”â”â”â”â”  50%  250/500 â€¢ 0:01:15 < 0:01:15
11-30 00:19:45 [CheckpointManager] âœ“ è‡ªåŠ¨ä¿å­˜checkpoint at step 250
11-30 00:20:10 [APT-Trainer] Epoch 1/10 å®Œæˆ - Loss: 2.3456, LR: 0.000090
11-30 00:20:10 [CheckpointManager] âœ“ Checkpointå·²ä¿å­˜: epoch 1, step 500 (1.2GB)
11-30 00:20:10 [APT-Trainer] â”â”â” Epoch 2/10 å¼€å§‹ â”â”â”
```

---

## ğŸš€ å®æ–½å»ºè®®

### ç«‹å³å®æ–½ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰:
1. âœ… æ·»åŠ æ—¶é—´æˆ³åˆ°æ—¥å¿—
2. âœ… æ·»åŠ checkpointæ¢å¤æç¤º
3. âœ… æ”¹è¿›è¿›åº¦æ¡ï¼ˆrichï¼‰

### åç»­å®æ–½ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰:
4. â³ ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ
5. â³ æ·»åŠ é‡è¯•æœºåˆ¶æç¤º
6. â³ æ·»åŠ ç»„ä»¶çº§æ—¥å¿—æ ‡ç­¾

### å¯é€‰å®æ–½ï¼ˆä½ä¼˜å…ˆçº§ï¼‰:
7. â¸ï¸ å®æ—¶ä»ªè¡¨ç›˜
8. â¸ï¸ Webå¯è§†åŒ–ç•Œé¢
9. â¸ï¸ TensorBoardé›†æˆå¢å¼º

---

**æ€»ç»“**: LPMMçš„è¾“å‡ºå±•ç¤ºäº†ä¸“ä¸šè®­ç»ƒç³»ç»Ÿåº”æœ‰çš„ç‰¹æ€§ï¼šæ—¶é—´æˆ³ã€æ¨¡å—åŒ–æ—¥å¿—ã€åŠ¨æ€è¿›åº¦ã€æ™ºèƒ½é‡è¯•ã€ç¼“å­˜æç¤ºã€æ¸…æ™°é”™è¯¯ã€‚APTæ¨¡å‹å¯ä»¥å€Ÿé‰´è¿™äº›ç‰¹æ€§ï¼Œå¤§å¹…æå‡è®­ç»ƒä½“éªŒã€‚
