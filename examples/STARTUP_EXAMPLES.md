# APT Model å¯åŠ¨ç¤ºä¾‹ - WebUIå’ŒAPI

æœ¬æ–‡æ¡£å±•ç¤ºå¯åŠ¨WebUIå’ŒAPIæ—¶çš„æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹ã€‚

---

## ğŸŒ WebUIå¯åŠ¨ç¤ºä¾‹

### åŸºç¡€å¯åŠ¨
```bash
python -m apt_model.webui.app --checkpoint-dir ./checkpoints
```

### å¯åŠ¨è¾“å‡ºï¼š
```
================================================================================
ğŸš€ APT Model WebUI å¯åŠ¨ä¸­...
================================================================================

ğŸ“‹ é…ç½®ä¿¡æ¯:
  ğŸŒ ä¸»æœºåœ°å€: 0.0.0.0
  ğŸ”Œ ç«¯å£: 7860
  ğŸ“ Checkpointç›®å½•: ./checkpoints
  ğŸŒ å…¬å…±åˆ†äº«: âŒ å¦
  ğŸ” è®¿é—®æ§åˆ¶: âš ï¸  æœªå¯ç”¨ (å»ºè®®ç”Ÿäº§ç¯å¢ƒå¯ç”¨)

ğŸŒ è®¿é—®åœ°å€:
  ğŸ“ æœ¬åœ°è®¿é—®: http://localhost:7860
  ğŸ“ å±€åŸŸç½‘è®¿é—®: http://<ä½ çš„IP>:7860

ğŸ’¡ åŠŸèƒ½è¯´æ˜:
  ğŸ“Š è®­ç»ƒç›‘æ§ - å®æ—¶æŸ¥çœ‹è®­ç»ƒlosså’Œå­¦ä¹ ç‡æ›²çº¿
  ğŸ” æ¢¯åº¦ç›‘æ§ - ç›‘æ§æ¢¯åº¦æµå’Œå¼‚å¸¸æ£€æµ‹
  ğŸ’¾ Checkpointç®¡ç† - ç®¡ç†å’ŒåŠ è½½æ¨¡å‹æ£€æŸ¥ç‚¹
  âœ¨ æ¨ç†æµ‹è¯• - äº¤äº’å¼æ–‡æœ¬ç”Ÿæˆ

================================================================================
âœ… WebUI å·²å¯åŠ¨ï¼è¯·åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä¸Šè¿°åœ°å€
================================================================================

Running on local URL:  http://127.0.0.1:7860

To create a public link, set `share=True` in `launch()`.
```

---

### å¸¦è®¤è¯çš„å¯åŠ¨
```bash
python -m apt_model.webui.app \
  --checkpoint-dir ./checkpoints \
  --username admin \
  --password your_password \
  --port 7860
```

### å¯åŠ¨è¾“å‡ºï¼ˆå¸¦è®¤è¯ï¼‰ï¼š
```
================================================================================
ğŸš€ APT Model WebUI å¯åŠ¨ä¸­...
================================================================================

ğŸ“‹ é…ç½®ä¿¡æ¯:
  ğŸŒ ä¸»æœºåœ°å€: 0.0.0.0
  ğŸ”Œ ç«¯å£: 7860
  ğŸ“ Checkpointç›®å½•: ./checkpoints
  ğŸŒ å…¬å…±åˆ†äº«: âŒ å¦
  ğŸ” è®¿é—®æ§åˆ¶: âœ… å·²å¯ç”¨ (ç”¨æˆ·å: admin)

ğŸŒ è®¿é—®åœ°å€:
  ğŸ“ æœ¬åœ°è®¿é—®: http://localhost:7860
  ğŸ“ å±€åŸŸç½‘è®¿é—®: http://<ä½ çš„IP>:7860

ğŸ”‘ ç™»å½•å‡­æ®:
  ğŸ‘¤ ç”¨æˆ·å: admin
  ğŸ”’ å¯†ç : your_password

ğŸ’¡ åŠŸèƒ½è¯´æ˜:
  ğŸ“Š è®­ç»ƒç›‘æ§ - å®æ—¶æŸ¥çœ‹è®­ç»ƒlosså’Œå­¦ä¹ ç‡æ›²çº¿
  ğŸ” æ¢¯åº¦ç›‘æ§ - ç›‘æ§æ¢¯åº¦æµå’Œå¼‚å¸¸æ£€æµ‹
  ğŸ’¾ Checkpointç®¡ç† - ç®¡ç†å’ŒåŠ è½½æ¨¡å‹æ£€æŸ¥ç‚¹
  âœ¨ æ¨ç†æµ‹è¯• - äº¤äº’å¼æ–‡æœ¬ç”Ÿæˆ

================================================================================
âœ… WebUI å·²å¯åŠ¨ï¼è¯·åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä¸Šè¿°åœ°å€
================================================================================
```

---

### å…¬å…±åˆ†äº«æ¨¡å¼
```bash
python -m apt_model.webui.app \
  --checkpoint-dir ./checkpoints \
  --share
```

### å¯åŠ¨è¾“å‡ºï¼ˆå…¬å…±åˆ†äº«ï¼‰ï¼š
```
================================================================================
ğŸš€ APT Model WebUI å¯åŠ¨ä¸­...
================================================================================

ğŸ“‹ é…ç½®ä¿¡æ¯:
  ğŸŒ ä¸»æœºåœ°å€: 0.0.0.0
  ğŸ”Œ ç«¯å£: 7860
  ğŸ“ Checkpointç›®å½•: ./checkpoints
  ğŸŒ å…¬å…±åˆ†äº«: âœ… æ˜¯
  ğŸ” è®¿é—®æ§åˆ¶: âš ï¸  æœªå¯ç”¨ (å»ºè®®ç”Ÿäº§ç¯å¢ƒå¯ç”¨)

ğŸŒ è®¿é—®åœ°å€:
  ğŸ“ æœ¬åœ°è®¿é—®: http://localhost:7860
  ğŸ“ å±€åŸŸç½‘è®¿é—®: http://<ä½ çš„IP>:7860

ğŸ’¡ åŠŸèƒ½è¯´æ˜:
  ğŸ“Š è®­ç»ƒç›‘æ§ - å®æ—¶æŸ¥çœ‹è®­ç»ƒlosså’Œå­¦ä¹ ç‡æ›²çº¿
  ğŸ” æ¢¯åº¦ç›‘æ§ - ç›‘æ§æ¢¯åº¦æµå’Œå¼‚å¸¸æ£€æµ‹
  ğŸ’¾ Checkpointç®¡ç† - ç®¡ç†å’ŒåŠ è½½æ¨¡å‹æ£€æŸ¥ç‚¹
  âœ¨ æ¨ç†æµ‹è¯• - äº¤äº’å¼æ–‡æœ¬ç”Ÿæˆ

================================================================================
âœ… WebUI å·²å¯åŠ¨ï¼è¯·åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä¸Šè¿°åœ°å€
================================================================================

Running on local URL:  http://127.0.0.1:7860
Running on public URL: https://xxxxx.gradio.live

This share link expires in 72 hours.
```

---

## ğŸš€ APIæœåŠ¡å™¨å¯åŠ¨ç¤ºä¾‹

### åŸºç¡€å¯åŠ¨
```bash
python -m apt_model.api.server --checkpoint-dir ./checkpoints
```

### å¯åŠ¨è¾“å‡ºï¼š
```
================================================================================
ğŸš€ APT Model REST API å¯åŠ¨ä¸­...
================================================================================

ğŸ“‹ é…ç½®ä¿¡æ¯:
  ğŸŒ ä¸»æœºåœ°å€: 0.0.0.0
  ğŸ”Œ ç«¯å£: 8000
  ğŸ“ Checkpointç›®å½•: ./checkpoints
  ğŸ”„ çƒ­é‡è½½: âŒ æœªå¯ç”¨
  ğŸ” PyTorch: âœ… å¯ç”¨
  ğŸš€ FastAPI: âœ… å¯ç”¨

ğŸŒ APIè®¿é—®åœ°å€:
  ğŸ“ æœ¬åœ°è®¿é—®: http://localhost:8000
  ğŸ“ å±€åŸŸç½‘è®¿é—®: http://<ä½ çš„IP>:8000

ğŸ“š APIæ–‡æ¡£:
  ğŸ“– Swagger UI: http://localhost:8000/docs
  ğŸ“– ReDoc: http://localhost:8000/redoc

ğŸ”‘ APIè®¿é—®å¯†é’¥ (è‡ªåŠ¨ç”Ÿæˆ):
  ğŸ” API Key: a7f3d9e2b8c1f4e6d5a9b3c7e2f8d1a4c9e5b7d3f1a8c4e6b2d9f5a1c7e3b8d4
  ğŸ’¡ è¯·å¦¥å–„ä¿å­˜æ­¤å¯†é’¥ï¼Œé‡å¯åå°†é‡æ–°ç”Ÿæˆ

ğŸ’¡ ä¸»è¦ç«¯ç‚¹:
  ğŸ¤– æ¨ç†æœåŠ¡:
     POST /api/generate - å•æ–‡æœ¬ç”Ÿæˆ
     POST /api/batch_generate - æ‰¹é‡ç”Ÿæˆ
  ğŸ“Š è®­ç»ƒç›‘æ§:
     GET /api/training/status - è®­ç»ƒçŠ¶æ€
     GET /api/training/gradients - æ¢¯åº¦æ•°æ®
  ğŸ’¾ Checkpointç®¡ç†:
     GET /api/checkpoints - åˆ—å‡ºcheckpoints
     POST /api/checkpoints/load - åŠ è½½checkpoint

ğŸ“ ä½¿ç”¨ç¤ºä¾‹:
  curl -X POST http://localhost:8000/api/generate \
    -H "Content-Type: application/json" \
    -d '{"text": "ä½ å¥½", "max_length": 50}'

================================================================================
âœ… APIæœåŠ¡å™¨å·²å¯åŠ¨ï¼
================================================================================

INFO:     Started server process [12345]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
```

---

### å¸¦è‡ªå®šä¹‰API Keyçš„å¯åŠ¨
```bash
python -m apt_model.api.server \
  --checkpoint-dir ./checkpoints \
  --api-key "my-secret-api-key-12345" \
  --port 8000
```

### å¯åŠ¨è¾“å‡ºï¼ˆè‡ªå®šä¹‰Keyï¼‰ï¼š
```
================================================================================
ğŸš€ APT Model REST API å¯åŠ¨ä¸­...
================================================================================

ğŸ“‹ é…ç½®ä¿¡æ¯:
  ğŸŒ ä¸»æœºåœ°å€: 0.0.0.0
  ğŸ”Œ ç«¯å£: 8000
  ğŸ“ Checkpointç›®å½•: ./checkpoints
  ğŸ”„ çƒ­é‡è½½: âŒ æœªå¯ç”¨
  ğŸ” PyTorch: âœ… å¯ç”¨
  ğŸš€ FastAPI: âœ… å¯ç”¨

ğŸŒ APIè®¿é—®åœ°å€:
  ğŸ“ æœ¬åœ°è®¿é—®: http://localhost:8000
  ğŸ“ å±€åŸŸç½‘è®¿é—®: http://<ä½ çš„IP>:8000

ğŸ“š APIæ–‡æ¡£:
  ğŸ“– Swagger UI: http://localhost:8000/docs
  ğŸ“– ReDoc: http://localhost:8000/redoc

ğŸ”‘ APIè®¿é—®å¯†é’¥:
  ğŸ” API Key: my-secret-api-k... (å·²åŠ è½½)

ğŸ’¡ ä¸»è¦ç«¯ç‚¹:
  ğŸ¤– æ¨ç†æœåŠ¡:
     POST /api/generate - å•æ–‡æœ¬ç”Ÿæˆ
     POST /api/batch_generate - æ‰¹é‡ç”Ÿæˆ
  ğŸ“Š è®­ç»ƒç›‘æ§:
     GET /api/training/status - è®­ç»ƒçŠ¶æ€
     GET /api/training/gradients - æ¢¯åº¦æ•°æ®
  ğŸ’¾ Checkpointç®¡ç†:
     GET /api/checkpoints - åˆ—å‡ºcheckpoints
     POST /api/checkpoints/load - åŠ è½½checkpoint

ğŸ“ ä½¿ç”¨ç¤ºä¾‹:
  curl -X POST http://localhost:8000/api/generate \
    -H "Content-Type: application/json" \
    -d '{"text": "ä½ å¥½", "max_length": 50}'

================================================================================
âœ… APIæœåŠ¡å™¨å·²å¯åŠ¨ï¼
================================================================================
```

---

### å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
```bash
python -m apt_model.api.server \
  --checkpoint-dir ./checkpoints \
  --reload \
  --port 8000
```

### å¯åŠ¨è¾“å‡ºï¼ˆçƒ­é‡è½½æ¨¡å¼ï¼‰ï¼š
```
================================================================================
ğŸš€ APT Model REST API å¯åŠ¨ä¸­...
================================================================================

ğŸ“‹ é…ç½®ä¿¡æ¯:
  ğŸŒ ä¸»æœºåœ°å€: 0.0.0.0
  ğŸ”Œ ç«¯å£: 8000
  ğŸ“ Checkpointç›®å½•: ./checkpoints
  ğŸ”„ çƒ­é‡è½½: âœ… å·²å¯ç”¨
  ğŸ” PyTorch: âœ… å¯ç”¨
  ğŸš€ FastAPI: âœ… å¯ç”¨

ğŸŒ APIè®¿é—®åœ°å€:
  ğŸ“ æœ¬åœ°è®¿é—®: http://localhost:8000
  ğŸ“ å±€åŸŸç½‘è®¿é—®: http://<ä½ çš„IP>:8000

ğŸ“š APIæ–‡æ¡£:
  ğŸ“– Swagger UI: http://localhost:8000/docs
  ğŸ“– ReDoc: http://localhost:8000/redoc

ğŸ”‘ APIè®¿é—®å¯†é’¥ (è‡ªåŠ¨ç”Ÿæˆ):
  ğŸ” API Key: b3e7a2f9c4d8e1a6f5b9c3e7d2a8f1c4e9b5d7a3f1c8e4b6d2f9a5c1e7b3d8
  ğŸ’¡ è¯·å¦¥å–„ä¿å­˜æ­¤å¯†é’¥ï¼Œé‡å¯åå°†é‡æ–°ç”Ÿæˆ

ğŸ’¡ ä¸»è¦ç«¯ç‚¹:
  ğŸ¤– æ¨ç†æœåŠ¡:
     POST /api/generate - å•æ–‡æœ¬ç”Ÿæˆ
     POST /api/batch_generate - æ‰¹é‡ç”Ÿæˆ
  ğŸ“Š è®­ç»ƒç›‘æ§:
     GET /api/training/status - è®­ç»ƒçŠ¶æ€
     GET /api/training/gradients - æ¢¯åº¦æ•°æ®
  ğŸ’¾ Checkpointç®¡ç†:
     GET /api/checkpoints - åˆ—å‡ºcheckpoints
     POST /api/checkpoints/load - åŠ è½½checkpoint

ğŸ“ ä½¿ç”¨ç¤ºä¾‹:
  curl -X POST http://localhost:8000/api/generate \
    -H "Content-Type: application/json" \
    -d '{"text": "ä½ å¥½", "max_length": 50}'

================================================================================
âœ… APIæœåŠ¡å™¨å·²å¯åŠ¨ï¼
================================================================================

INFO:     Will watch for changes in these directories: ['/path/to/APT-Transformer']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [12345] using StatReload
INFO:     Started server process [12346]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
```

---

## ğŸ“Œ é‡è¦è¯´æ˜

### WebUIè®¿é—®æ§åˆ¶
- **æ— è®¤è¯æ¨¡å¼**: ä»»ä½•äººéƒ½å¯ä»¥è®¿é—®ï¼ˆä»…æœ¬åœ°å¼€å‘ä½¿ç”¨ï¼‰
- **è®¤è¯æ¨¡å¼**: éœ€è¦ç”¨æˆ·åå’Œå¯†ç ç™»å½•ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰
  ```bash
  --username admin --password your_secure_password
  ```

### APIå¯†é’¥ç®¡ç†
- **è‡ªåŠ¨ç”Ÿæˆ**: å¯åŠ¨æ—¶è‡ªåŠ¨ç”Ÿæˆ64å­—ç¬¦çš„éšæœºå¯†é’¥
- **è‡ªå®šä¹‰å¯†é’¥**: ä½¿ç”¨ `--api-key` å‚æ•°æŒ‡å®š
- **ä¿å­˜å¯†é’¥**: è¯·å¦¥å–„ä¿å­˜å¯†é’¥ï¼Œé‡å¯åè‡ªåŠ¨ç”Ÿæˆçš„å¯†é’¥ä¼šæ”¹å˜

### ç«¯å£è¯´æ˜
- **WebUIé»˜è®¤ç«¯å£**: 7860
- **APIé»˜è®¤ç«¯å£**: 8000
- å¯é€šè¿‡ `--port` å‚æ•°è‡ªå®šä¹‰

### è®¿é—®æ–¹å¼

**æœ¬åœ°è®¿é—®**:
- WebUI: http://localhost:7860
- APIæ–‡æ¡£: http://localhost:8000/docs

**å±€åŸŸç½‘è®¿é—®**:
- éœ€è¦çŸ¥é“æœåŠ¡å™¨çš„IPåœ°å€
- ç¡®ä¿é˜²ç«å¢™å…è®¸å¯¹åº”ç«¯å£

**å…¬ç½‘è®¿é—®** (ä»…WebUI):
- ä½¿ç”¨ `--share` å‚æ•°
- Gradioä¼šç”Ÿæˆä¸€ä¸ªä¸´æ—¶çš„å…¬ç½‘é“¾æ¥ï¼ˆ72å°æ—¶æœ‰æ•ˆï¼‰

---

## ğŸ”§ å®Œæ•´å‘½ä»¤å‚è€ƒ

### WebUI
```bash
python -m apt_model.webui.app \
  --checkpoint-dir <è·¯å¾„> \
  --port <ç«¯å£> \
  --host <ä¸»æœºåœ°å€> \
  --username <ç”¨æˆ·å> \
  --password <å¯†ç > \
  --share
```

### API Server
```bash
python -m apt_model.api.server \
  --checkpoint-dir <è·¯å¾„> \
  --port <ç«¯å£> \
  --host <ä¸»æœºåœ°å€> \
  --api-key <å¯†é’¥> \
  --reload
```

---

**æç¤º**: å¯åŠ¨ä¿¡æ¯ä¸­çš„è¡¨æƒ…ç¬¦å·å’Œæ ¼å¼åŒ–è¾“å‡ºå¯ä»¥å¸®åŠ©æ‚¨å¿«é€Ÿäº†è§£æœåŠ¡é…ç½®å’Œè®¿é—®æ–¹å¼ï¼
