================================================================================
Virtual Blackwell v6.0 训练速度测试（精度分离缓存优化）
================================================================================
设备: cpu

创建Claude4模型...
模型参数: 35,862,532

应用Virtual Blackwell...
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: encoder.image_proj (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: encoder.audio_proj (512 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.attn.W_q (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.attn.W_k (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.attn.W_v (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.attn.W_o (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.ffn.experts.0.0 (256 -> 1024)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.ffn.experts.0.2 (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.ffn.experts.1.0 (256 -> 1024)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.ffn.experts.1.2 (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.ffn.experts.2.0 (256 -> 1024)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.ffn.experts.2.2 (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.ffn.experts.3.0 (256 -> 1024)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.ffn.experts.3.2 (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.0.ffn.gate (256 -> 4)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.attn.W_q (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.attn.W_k (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.attn.W_v (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.attn.W_o (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.ffn.experts.0.0 (256 -> 1024)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.ffn.experts.0.2 (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.ffn.experts.1.0 (256 -> 1024)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.ffn.experts.1.2 (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.ffn.experts.2.0 (256 -> 1024)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.ffn.experts.2.2 (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.ffn.experts.3.0 (256 -> 1024)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.ffn.experts.3.2 (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.ffn.gate (256 -> 4)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.reflection.connectivity_analyzer.connectivity_proj (256 -> 1)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.reflection.shortest_path_reflection.path_attn.out_proj (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.reflection.mirror_complexity.mirror_projs.0 (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.reflection.mirror_complexity.mirror_projs.1 (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.reflection.mirror_complexity.mirror_projs.2 (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.reflection.mirror_complexity.complexity_scorer.0 (768 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.reflection.mirror_complexity.complexity_scorer.2 (256 -> 1)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.reflection.fusion.0 (768 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.reflection.fusion.4 (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.1.reflection.feedback_gate.0 (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.attn.W_q (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.attn.W_k (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.attn.W_v (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.attn.W_o (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.ffn.experts.0.0 (256 -> 1024)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.ffn.experts.0.2 (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.ffn.experts.1.0 (256 -> 1024)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.ffn.experts.1.2 (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.ffn.experts.2.0 (256 -> 1024)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.ffn.experts.2.2 (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.ffn.experts.3.0 (256 -> 1024)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.ffn.experts.3.2 (1024 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.ffn.gate (256 -> 4)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.reflection.connectivity_analyzer.connectivity_proj (256 -> 1)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.reflection.shortest_path_reflection.path_attn.out_proj (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.reflection.mirror_complexity.mirror_projs.0 (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.reflection.mirror_complexity.mirror_projs.1 (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.reflection.mirror_complexity.mirror_projs.2 (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.reflection.mirror_complexity.complexity_scorer.0 (768 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.reflection.mirror_complexity.complexity_scorer.2 (256 -> 1)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.reflection.fusion.0 (768 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.reflection.fusion.4 (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: blocks.2.reflection.feedback_gate.0 (256 -> 256)
[虚拟Blackwell] 模式=训练, FP4=启用, BOH量化=启用
[OK] 替换层: output_head (256 -> 50000)
虚拟Blackwell显卡: 62 张

配置: batch_size=8, seq_len=128, batches=20
================================================================================

开始训练测试...
--------------------------------------------------------------------------------
